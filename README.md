# som
Basic Self Organizing Map implementation for genome analysis.

This repository contains code files for the undergraduate thesis project titled "Self Organizing Map for genome analysis". This project aims to generate a clustering of bacterial genomes based on a structural representation of its DNA sequence.

The programs are provided here for purely academic purposes. Use them at your own risk. 

## vector.c
Contains code to generate a vector representation of a genomic DNA sequence in fasta format. It calculates frequencies of dinucleotides. The resulting vector has dimension 16.

Usage:

```
$ zcat INPUT.fna.gz | ./vector > OUTPUT
```

## matrix.sh
Bash script to generate a matrix with the vector representations of a set of genomic sequences. It scans the subdirectory with the compressed fasta sequences, applies the program  `vector` on each sequence, and stores each vector as a line in an output file. If there are N fasta files, the resulting matrix has dimension Nx16.

Usage:
```
$ bash matrix.sh
```
Relevant variables inside the script:
```
GENOMES: the subdirectory with the fasta sequences
MATRIX: the name of the output file
```
## som.c
Contains a basic general implementation of Kohonen's SOM algorithm. It can be used in any dataset. 

Usage:
```
$ som [-x NROWS] [-y NCOLS] [-e EPOCHS] [-a ALPHA0] [-s SIGMA0] [-o OUTPUTFILE] [-l LOG] [-r] INPUTFILE
  -x NROWS: an integer number for the x dimension of the map
  -y NCOLS: an integer number for the y dimension of the map
  -e EPOCHS: number of epochs
  -a ALPHA0: a float number representing the initial learning factor
  -s SIGMA0: a float number for the initial sigma value, used to calculate the radius
  -o OUTPUTFILE: the name of the output file
  -l LOG: if 1, save a log of the run
  -r : if present, the next input vector will be selected randomly; if not, sequentially
  INPUTFILE: the name of the dataset file; the first line must contain the dimension of the inputs.
```
INPUTFILE is the data file generated by the `matrix.sh` script.

## plot.sh
Bash script to generate a plot of the results. Requires `gnuplot`.

Usage:
```
$ bash plot.sh SOMFILE
```
SOMFILE is the output file of the `som` program.

Relevant variables inside the script:
```
NUMCLUST: defines the number of clusters to show in the plot
PAUSE: if 0, save the plot directly to a PNG file; if 1, keep the gnuplot window open
```

Sample plots:

![genomes](https://github.com/chuseq/som/blob/master/genomes.png "Sample genomes clustering")
![iris](https://github.com/chuseq/som/blob/master/iris.png "Sample IRIS data set clustering")

## sompak.sh
Bash script to run the programs in the [SOM_PAK](http://www.cis.hut.fi/research/som-research/nnrc-programs.shtml) package.

Usage:
```
$ bash sompak.sh
```
Relevant variables inside the script: DATADIR, DATAFILE, RESULTSDIR, LOGFILE, PATH

# Author
Alfredo José Hernández Alvarez - chuseq@gmail.com
